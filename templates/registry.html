<!DOCTYPE html>
<html>
<head>
    <title>Registry Analysis</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>

<h2 class="center">Registry Analysis</h2>

<div class="upload-box">
    <form method="POST" enctype="multipart/form-data">
        <input type="file" name="registry_file" required>
        <button type="submit">Analyze</button>
    </form>
</div>

{% if error %}
<p class="error">{{ error }}</p>
{% endif %}

{% if results %}
<hr>

<p><b>Total Keys:</b> {{ total }}</p>
<p><b>Findings:</b> {{ findings }}</p>

<table>
    <tr>
        <th>Registry Key</th>
        <th>Name</th>
        <th>Data</th>
        <th>Risk Level</th>
    </tr>

    {% for r in results %}
    <tr class="{{ r.risk|lower }}">
        <td>{{ r.key }}</td>
        <td>{{ r.name }}</td>
        <td>{{ r.data }}</td>
        <td>{{ r.risk }}</td>
    </tr>
    {% endfor %}
</table>

<form action="{{ url_for('export_registry') }}" method="get">
    <button type="submit">Export CSV</button>
</form>

{% endif %}

</body>
</html>
